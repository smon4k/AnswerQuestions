webpackJsonp([5],{"+haf":function(e,a,n){"use strict";var t=n("mtWM"),r=n.n(t),i=(n("GKmE"),n("NYxO")),o=n("Fd2+"),s=n("WTx0"),c=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e};function d(e){return function(){var a=e.apply(this,arguments);return new Promise(function(e,n){return function t(r,i){try{var o=a[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){t("next",e)},function(e){t("throw",e)});e(s)}("next")})}}function u(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}a.a={name:"userSetup",data:function(){return{active:2,avatarFileObj:"",isNameShow:!1,isPasswordShow:!1,username:"",isUsername:!1,password:"",qr_password:"",m_password:"",showBirthdayPicker:!1,showAreaPicker:!1,isconfirm:!0,pattern:/\d{6}/,usernameShow:!1}},created:function(){},computed:c({},Object(i.c)({address:function(e){return e.base.address},userId:function(e){return e.base.userId},isConnected:function(e){return e.base.isConnected},apiUrl:function(e){return e.base.apiUrl},isMobel:function(e){return e.comps.isMobel}}),{changeData:function(){return{userId:this.userId,apiUrl:this.apiUrl,address:this.address}}}),watch:{changeData:{immediate:!0,handler:function(e){console.log(e),e.userId>0&&this.getUserInfo()}}},components:u({},o.a.Component.name,o.a.Component),mounted:function(){},methods:{usernameValidator:function(e){return!!/^[a-zA-Z]([-_a-zA-Z0-9_]{5,14})$/.test(e)},passwordValidator:function(e){return!!/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/.test(e)},qrPasswordValidator:function(e){return e===this.password},getUserInfo:function(){var e=this;return d(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.get(e.apiUrl+"/Api/User/getUserInfo",{params:{userId:e.userId}}).then(function(){var a=d(regeneratorRuntime.mark(function a(n){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n&&1e4==n.code?(console.log(n.data),n.data.username&&""!==n.data.username&&(e.isUsername=!0),e.username=n.data.username):e.$notify({type:"danger",message:"Error"}),a.abrupt("return");case 2:case"end":return a.stop()}},a,e)}));return function(e){return a.apply(this,arguments)}}()).catch(function(a){e.$notify({type:"danger",message:a})});case 2:case"end":return a.stop()}},a,e)}))()},onClickSure:function(){this.isNameShow=!1},onClickSave:function(){this.$router.go(-1)},onClickSaveUserInfo:function(e,a){var n=this;return d(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("username"!==e){t.next=3;break}if(n.usernameValidator(n.username)){t.next=3;break}return t.abrupt("return",!1);case 3:if("password"!==e){t.next=6;break}if(n.passwordValidator(n.password)&&n.passwordValidator(n.qr_password)){t.next=6;break}return t.abrupt("return",!1);case 6:return i=u({userId:n.userId},e,a),t.next=9,r.a.post(n.apiUrl+"/Api/User/saveUserInfo",i).then(function(){var e=d(regeneratorRuntime.mark(function e(a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a&&1e4==a.code?(n.isNameShow=!1,n.isPasswordShow=!1,n.getUserInfo(),n.$notify({type:"success",message:"Success"})):a&&10001==a.code?(n.usernameShow=!0,n.$notify({type:"warning",message:a.msg})):n.$notify({type:"warning",message:a.msg}),e.abrupt("return");case 2:case"end":return e.stop()}},e,n)}));return function(a){return e.apply(this,arguments)}}()).catch(function(e){n.$notify({type:"danger",message:e})});case 9:case"end":return t.stop()}},t,n)}))()},onBeforeClose:function(e,a){return"confirm"===e?a(!1):a()},margintSubmit:function(){var e=this;return d(regeneratorRuntime.mark(function a(){var n,t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.m_password||""===e.m_password){a.next=7;break}return n={userId:e.userId,username:e.username,password:e.m_password},t=e.$loading({lock:!0,text:"账号合并中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a.next=5,r.a.post(e.apiUrl+"/Api/User/marginUsername",n).then(function(){var a=d(regeneratorRuntime.mark(function a(n){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t.close(),!n||1e4!=n.code){a.next=8;break}e.getUserInfo(),e.usernameShow=!1,e.isNameShow=!1,e.$notify({type:"success",message:"Success"}),a.next=10;break;case 8:return e.$notify({type:"warning",message:n.msg}),a.abrupt("return",!1);case 10:return a.abrupt("return");case 11:case"end":return a.stop()}},a,e)}));return function(e){return a.apply(this,arguments)}}()).catch(function(a){e.$notify({type:"danger",message:a})});case 5:a.next=8;break;case 7:e.$notify({type:"danger",message:"请输入密码"});case 8:return a.abrupt("return",!1);case 9:case"end":return a.stop()}},a,e)}))()},onConfirm:function(e){this.birthday=this.timeFormat(e),this.showBirthdayPicker=!1},addressStr:function(){return this.address&&void 0!=this.address&&""!=this.address?this.address.substring(0,4)+"***"+this.address.substring(this.address.length-3):"Connect Wallet"},connectWalletClick:function(){var e=this;return d(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0!=window.ethereum){a.next=3;break}return e.$notify({type:"warning",message:"You do not have metamask installed"}),a.abrupt("return",!1);case 3:if(e.address&&void 0!=e.address&&""!=e.address){a.next=8;break}return a.next=6,Object(s.c)();case 6:a.next=10;break;case 8:return a.next=10,Object(s.b)();case 10:case"end":return a.stop()}},a,e)}))()},LoginOut:function(){var e=this;return d(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(s.b)();case 2:e.$notify({type:"success",message:"退出成功"}),setTimeout(function(){e.$router.push("/login")},1e3);case 4:case"end":return a.stop()}},a,e)}))()}}}},"8ThQ":function(e,a,n){e.exports=n.p+"static/img/2.9d44a18.jpg"},Fqnv:function(e,a,n){var t=n("kxFB");(e.exports=n("FZ+f")(!0)).push([e.i,".container[data-v-911a0bc4] .bg{background-image:url("+t(n("8ThQ"))+");background-repeat:no-repeat;background-attachment:fixed;background-position:50%;top:0;left:0;width:100%;height:100%;z-index:-10;position:fixed;filter:blur(2px)}.container[data-v-911a0bc4] .van-nav-bar{background-color:transparent}.container[data-v-911a0bc4] .van-nav-bar .van-nav-bar__left i{color:#fff;font-size:20px}.container[data-v-911a0bc4] .van-nav-bar .van-nav-bar__title{color:#fff}.container[data-v-911a0bc4] .box{width:90%;height:80vh;margin:0 auto;background-color:#ae8bf5;margin-top:30px;border-radius:20px}.container[data-v-911a0bc4] .box .content{padding:16px 16px 160px}.container[data-v-911a0bc4] .box .van-popup--bottom.van-popup--round{height:100vh;border-radius:0}.container[data-v-911a0bc4] .box .van-action-sheet{max-height:100%}.container[data-v-911a0bc4] .box .item .item-index .van-cell{border-radius:20px}.container[data-v-911a0bc4] .box .item .item-index .van-cell .van-cell__value{color:#fff}.container[data-v-911a0bc4] .box .item .item-index .van-cell--clickable{height:50px;line-height:30px;vertical-align:middle;background-color:#ae8bf5;color:#fff}.container[data-v-911a0bc4] .box .item .item-index .van-popup{background-color:#ae8bf5}.container[data-v-911a0bc4] .box .item .item-index .van-popup .van-nav-bar__text{color:#fff}.container[data-v-911a0bc4] .box .item .item-index .hint{color:#fff;padding-left:15px;font-size:15px}.container[data-v-911a0bc4] .box .item .item-index .van-cell__left-icon,.container[data-v-911a0bc4] .box .item .item-index .van-cell__right-icon{line-height:30px;color:#fff}.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell,.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-picker{width:95%;border-radius:15px;margin:0 auto}.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell-group{margin:10px;border-radius:15px}.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell-group .van-cell{border-radius:15px}.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-hairline--top-bottom:after{border-width:inherit!important}.container[data-v-911a0bc4] .box .item .item-index .merge-box{padding:20px}.container[data-v-911a0bc4] .box .item .item-index .merge-box .van-field__label{width:50px}","",{version:3,sources:["/Users/qinlinhui/Sites/WWW/AnswerQuestions/src/views/user/setup.vue"],names:[],mappings:"AACA,gCAAgC,+CAAkD,4BAA4B,4BAA4B,wBAA2B,MAAM,OAAO,WAAW,YAAY,YAAY,eAAe,gBAAgB,CACnP,AACD,yCAAyC,4BAA4B,CACpE,AACD,8DAA8D,WAAW,cAAc,CACtF,AACD,6DAA6D,UAAU,CACtE,AACD,iCAAiC,UAAU,YAAY,cAAc,yBAAyB,gBAAgB,kBAAkB,CAC/H,AACD,0CAA0C,uBAAuB,CAChE,AACD,qEAAqE,aAAa,eAAe,CAChG,AACD,mDAAmD,eAAe,CACjE,AACD,6DAA6D,kBAAkB,CAC9E,AACD,8EAA8E,UAAU,CACvF,AACD,wEAAwE,YAAY,iBAAiB,sBAAsB,yBAAyB,UAAU,CAC7J,AACD,8DAA8D,wBAAwB,CACrF,AACD,iFAAiF,UAAU,CAC1F,AACD,yDAAyD,WAAW,kBAAkB,cAAc,CACnG,AACD,iJAAiJ,iBAAiB,UAAU,CAC3K,AACD,kJAAkJ,UAAU,mBAAmB,aAAa,CAC3L,AACD,8EAA8E,YAAY,kBAAkB,CAC3G,AACD,wFAAwF,kBAAkB,CACzG,AACD,8FAA+F,8BAA+B,CAC7H,AACD,8DAA8D,YAAY,CACzE,AACD,gFAAgF,UAAU,CACzF",file:"setup.vue",sourcesContent:['\n.container[data-v-911a0bc4] .bg{background-image:url("../../assets/answer/2.jpg");background-repeat:no-repeat;background-attachment:fixed;background-position:center;top:0;left:0;width:100%;height:100%;z-index:-10;position:fixed;filter:blur(2px)\n}\n.container[data-v-911a0bc4] .van-nav-bar{background-color:transparent\n}\n.container[data-v-911a0bc4] .van-nav-bar .van-nav-bar__left i{color:#fff;font-size:20px\n}\n.container[data-v-911a0bc4] .van-nav-bar .van-nav-bar__title{color:#fff\n}\n.container[data-v-911a0bc4] .box{width:90%;height:80vh;margin:0 auto;background-color:#AE8BF5;margin-top:30px;border-radius:20px\n}\n.container[data-v-911a0bc4] .box .content{padding:16px 16px 160px\n}\n.container[data-v-911a0bc4] .box .van-popup--bottom.van-popup--round{height:100vh;border-radius:0\n}\n.container[data-v-911a0bc4] .box .van-action-sheet{max-height:100%\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-cell{border-radius:20px\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-cell .van-cell__value{color:#fff\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-cell--clickable{height:50px;line-height:30px;vertical-align:middle;background-color:#AE8BF5;color:#fff\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-popup{background-color:#AE8BF5\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-popup .van-nav-bar__text{color:#fff\n}\n.container[data-v-911a0bc4] .box .item .item-index .hint{color:#fff;padding-left:15px;font-size:15px\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-cell__left-icon,.container[data-v-911a0bc4] .box .item .item-index .van-cell__right-icon{line-height:30px;color:#fff\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell,.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-picker{width:95%;border-radius:15px;margin:0 auto\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell-group{margin:10px;border-radius:15px\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-cell-group .van-cell{border-radius:15px\n}\n.container[data-v-911a0bc4] .box .item .item-index .van-sheet .van-hairline--top-bottom::after{border-width:inherit !important\n}\n.container[data-v-911a0bc4] .box .item .item-index .merge-box{padding:20px\n}\n.container[data-v-911a0bc4] .box .item .item-index .merge-box .van-field__label{width:50px\n}\n'],sourceRoot:""}])},Y9EI:function(e,a,n){"use strict";var t={render:function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"container"},[n("div",{staticClass:"bg",style:{backgroundSize:e.isMobel?"100% 100%":""}}),e._v(" "),n("van-nav-bar",{attrs:{title:"设置","left-text":"","right-text":"","left-arrow":""},on:{"click-left":e.onClickSave}}),e._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"item"},[n("div",{staticClass:"item-index"},[n("van-cell",{attrs:{"is-link":"",title:"登录用户名"},on:{click:function(a){e.isNameShow=!0}}},[n("div",[e._v(e._s(e.username?e.username:"请输入用户名"))])]),e._v(" "),n("van-action-sheet",{staticClass:"van-sheet",attrs:{title:"","close-on-click-action":""},model:{value:e.isNameShow,callback:function(a){e.isNameShow=a},expression:"isNameShow"}},[n("van-nav-bar",{attrs:{title:"设置用户名","left-text":"取消","right-text":e.isUsername?"":"保存"},on:{"click-left":function(a){e.isNameShow=!1},"click-right":function(a){return e.onClickSaveUserInfo("username",e.username)}}}),e._v(" "),e.isUsername&&""!=e.isUsername?n("span",{staticClass:"hint"},[e._v("修改次数已达上限")]):n("span",{staticClass:"hint"},[e._v("账号只能设置一次")]),e._v(" "),n("van-cell-group",[n("van-form",[n("van-field",{attrs:{label:"",placeholder:"请输入用户名",disabled:!(!e.isUsername||""===e.isUsername),rules:[{validator:e.usernameValidator,message:"请输入正确的用户名"}]},model:{value:e.username,callback:function(a){e.username=a},expression:"username"}})],1)],1),e._v(" "),n("span",{staticClass:"hint"},[e._v("6-15个字符，仅可使用英文（必须）、数字、下划线")])],1)],1),e._v(" "),n("div",{staticClass:"item-index"},[n("van-cell",{attrs:{"is-link":"",title:"登录密码"},on:{click:function(a){e.isPasswordShow=!0}}}),e._v(" "),n("van-action-sheet",{staticClass:"van-sheet",attrs:{title:"","close-on-click-action":""},model:{value:e.isPasswordShow,callback:function(a){e.isPasswordShow=a},expression:"isPasswordShow"}},[n("van-nav-bar",{attrs:{title:"设置密码","left-text":"取消","right-text":"保存"},on:{"click-left":function(a){e.isPasswordShow=!1},"click-right":function(a){return e.onClickSaveUserInfo("password",e.password)}}}),e._v(" "),n("van-cell-group",[n("van-form",[n("van-field",{attrs:{type:"password",label:"",placeholder:"输入新的密码",rules:[{validator:e.passwordValidator,message:"请输入正确的密码"}]},model:{value:e.password,callback:function(a){e.password=a},expression:"password"}}),e._v(" "),n("van-field",{attrs:{type:"password",label:"",placeholder:"再次输入新的密码",rules:[{validator:e.qrPasswordValidator,message:"两次输入的密码不一致"}]},model:{value:e.qr_password,callback:function(a){e.qr_password=a},expression:"qr_password"}})],1)],1),e._v(" "),n("span",{staticClass:"hint"},[e._v("6-16位密码，同时包含字母和数字")])],1)],1),e._v(" "),n("div",{staticClass:"item-index"},[n("van-cell",{attrs:{"is-link":"",title:"钱包地址"},on:{click:function(a){return e.connectWalletClick()}}},[n("div",[e._v(e._s(e.addressStr()))])])],1),e._v(" "),n("div",{staticClass:"item-index"},[n("van-cell",{attrs:{"is-link":"",title:"退出登录"},on:{click:e.LoginOut}})],1)])]),e._v(" "),n("van-dialog",{attrs:{title:"用户名合并","show-cancel-button":"","before-close":e.onBeforeClose},on:{confirm:e.margintSubmit},model:{value:e.usernameShow,callback:function(a){e.usernameShow=a},expression:"usernameShow"}},[n("div",{staticClass:"merge-box"},[n("van-field",{attrs:{name:"用户名",label:"用户名",placeholder:"用户名",readonly:""},model:{value:e.username,callback:function(a){e.username=a},expression:"username"}}),e._v(" "),n("van-field",{attrs:{type:"password",name:"密码",label:"密码",placeholder:"密码"},model:{value:e.m_password,callback:function(a){e.m_password=a},expression:"m_password"}})],1)])],1)},staticRenderFns:[]};a.a=t},b2rU:function(e,a,n){var t=n("Fqnv");"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);n("rjj0")("3f24f814",t,!0,{})},pVz8:function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=n("+haf"),r=n("Y9EI");var i=function(e){n("b2rU")},o=n("VU/8")(t.a,r.a,!1,i,"data-v-911a0bc4",null);a.default=o.exports}});